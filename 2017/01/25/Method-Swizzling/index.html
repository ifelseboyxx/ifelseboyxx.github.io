<!DOCTYPE html>
<html lang="zh-cn">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="å¦‚æœå¯¹ Runtime æœ‰ä¸€å®šäº†è§£çš„è¯ï¼Œä¸€å®šå¬è¯´è¿‡æˆ–è€…ç”¨è¿‡è¿™ä¸ªå‡½æ•°ï¼š
1OBJC_EXPORT void method_exchangeImplementations(Method m1, Method m2)
å®ƒé€šå¸¸å«åš Method Swizzlingï¼Œç®—æ˜¯objcçš„ â€œé»‘é­”æ³•â€ äº†ï¼Œä½œç”¨å°±æ˜¯åœ¨">
    

    <!--Author-->
    
        <meta name="author" content="ifelseboyxx">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="æµ…è°ˆ Method Swizzling"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="ifelseboyxx&#39;s Blog"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

        <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>æµ…è°ˆ Method Swizzling - ifelseboyxx&#39;s Blog</title>

    <!-- Bootstrap Core CSS -->
    <link href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdn.bootcss.com/featherlight/1.7.1/featherlight.min.css" type="text/css" rel="stylesheet">

    <!-- Google Analytics -->
    


    <!-- favicon -->
    
    <link rel="icon" href="/img/red.png">
    
	
</head>


<body>

    <!-- Menu -->
    
        <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">ifelseboyxx {"ğŸ¤¢"}</a>

        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    
                        <li class="previous" title="Masonry æºç è§£æ">
                            <a href="/2017/02/23/Masonry-Analysis/">&larr; ä¸Šä¸€é¡µ</a>
                        </li>
                    
                </li>
                <li>
                    
                        <li class="next" title="è‡ªå®šä¹‰ Xcode ViewController ç±»æ¨¡æ¿">
                            <a href="/2017/01/02/Xcode-VC-Template/">ä¸‹ä¸€é¡µ  &rarr;</a>
                        </li>
                    
                </li>

                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/ifelseboyxx">
                            
                                GitHub
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://juejin.im/user/5a421a5ef265da4320038046">
                            
                                æ˜é‡‘
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
    

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->


<header class="intro-header">
    <div class="container">
    </div>
</header>


<div class="container">
    <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-preview">
                <!-- Title -->
                <a href="/2017/01/25/Method-Swizzling/">
                    <h2 class="post-title">
                        æµ…è°ˆ Method Swizzling
                    </h2>
                </a>

                <!-- Tags -->
                
                  
                        <a href="/tags/ObjC/" rel="tag" class="post-tag">
                        ObjC
                      </a>
                  
                

                <p class="post-meta">
                    <!-- Date and Author -->
                    
                    2017-01-25
                </p>
            </div>
            <hr>
        </div>
    </div>
</div>


<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>å¦‚æœå¯¹ Runtime æœ‰ä¸€å®šäº†è§£çš„è¯ï¼Œä¸€å®šå¬è¯´è¿‡æˆ–è€…ç”¨è¿‡è¿™ä¸ªå‡½æ•°ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">OBJC_EXPORT <span class="keyword">void</span> method_exchangeImplementations(Method m1, Method m2)</div></pre></td></tr></table></figure>
<p>å®ƒé€šå¸¸å«åš Method Swizzlingï¼Œç®—æ˜¯<code>objc</code>çš„ â€œé»‘é­”æ³•â€ äº†ï¼Œä½œç”¨å°±æ˜¯åœ¨ç¨‹åºè¿è¡ŒæœŸé—´åŠ¨æ€çš„ç»™ä¸¤ä¸ªæ–¹æ³•äº’æ¢å®ç°ã€‚</p>
<p>æœ€è¿‘æœ‰ç”¨åˆ°è¿™ä¸ªï¼Œæ€»ç»“ä¸‹é‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼š</p>
<h4 id="é™æ€ï¼ˆç±»ï¼‰æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•çš„äº¤æ¢å®ç°æ–¹å¼ä¸€æ ·å—ï¼Ÿ"><a href="#é™æ€ï¼ˆç±»ï¼‰æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•çš„äº¤æ¢å®ç°æ–¹å¼ä¸€æ ·å—ï¼Ÿ" class="headerlink" title="é™æ€ï¼ˆç±»ï¼‰æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•çš„äº¤æ¢å®ç°æ–¹å¼ä¸€æ ·å—ï¼Ÿ"></a>é™æ€ï¼ˆç±»ï¼‰æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•çš„äº¤æ¢å®ç°æ–¹å¼ä¸€æ ·å—ï¼Ÿ</h4><p>äº¤æ¢é™æ€ï¼ˆç±»ï¼‰æ–¹æ³•çš„æ­£ç¡®å§¿åŠ¿ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">+ (<span class="keyword">void</span>)load &#123;</div><div class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</div><div class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</div><div class="line">        SEL s1 = <span class="keyword">@selector</span>(go);</div><div class="line">        SEL s2 = <span class="keyword">@selector</span>(stop);</div><div class="line">        Class <span class="keyword">class</span> = object_getClass((<span class="keyword">id</span>)<span class="keyword">self</span>);</div><div class="line">        Method m1 = class_getClassMethod(<span class="keyword">class</span>, s1);</div><div class="line">        Method m2 = class_getClassMethod(<span class="keyword">class</span>, s2);</div><div class="line">        <span class="built_in">BOOL</span> success = class_addMethod(<span class="keyword">class</span>, s1, method_getImplementation(m2), method_getTypeEncoding(m2));</div><div class="line">        <span class="keyword">if</span> (success)&#123;</div><div class="line">            class_replaceMethod(<span class="keyword">class</span>, s2, method_getImplementation(m1), method_getTypeEncoding(m1));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            method_exchangeImplementations(m1, m2);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)go &#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"Go!"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)stop &#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"Stop!"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>äº¤æ¢å®ä¾‹æ–¹æ³•çš„æ­£ç¡®å§¿åŠ¿ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">+ (<span class="keyword">void</span>)load &#123;</div><div class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</div><div class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</div><div class="line">        SEL s1 = <span class="keyword">@selector</span>(go);</div><div class="line">        SEL s2 = <span class="keyword">@selector</span>(stop);</div><div class="line">        Class <span class="keyword">class</span> = [<span class="keyword">self</span> <span class="keyword">class</span>];</div><div class="line">        Method m1 = class_getInstanceMethod(<span class="keyword">class</span>, s1);</div><div class="line">        Method m2 = class_getInstanceMethod(<span class="keyword">class</span>, s2);</div><div class="line">        <span class="built_in">BOOL</span> success = class_addMethod(<span class="keyword">class</span>, s1, method_getImplementation(m2), method_getTypeEncoding(m2));</div><div class="line">        <span class="keyword">if</span> (success)&#123;</div><div class="line">            class_replaceMethod(<span class="keyword">class</span>, s2, method_getImplementation(m1), method_getTypeEncoding(m1));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            method_exchangeImplementations(m1, m2);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)go &#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"Go!"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)stop &#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"Stop!"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥å‘ç°ä¸Šé¢ä¸¤æ®µæ–¹æ³•çš„åŒºåˆ«åœ¨äºï¼š</p>
<p>é™æ€ï¼ˆç±»ï¼‰æ–¹æ³•çš„<code>Class</code>å’Œ<code>Method</code>æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Class <span class="keyword">class</span> = object_getClass((<span class="keyword">id</span>)<span class="keyword">self</span>);</div><div class="line">Method m1 = class_getClassMethod(<span class="keyword">class</span>, s1);</div><div class="line">Method m2 = class_getClassMethod(<span class="keyword">class</span>, s2);</div></pre></td></tr></table></figure>
<p>å®ä¾‹æ–¹æ³•çš„<code>Class</code>å’Œ<code>Method</code>æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Class <span class="keyword">class</span> = [<span class="keyword">self</span> <span class="keyword">class</span>];</div><div class="line">Method m1 = class_getInstanceMethod(<span class="keyword">class</span>, s1);</div><div class="line">Method m2 = class_getInstanceMethod(<span class="keyword">class</span>, s2);</div></pre></td></tr></table></figure>
<p>Runtime ä¸­<code>class_getClassMethod</code>çš„å®ç°ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Method class_getClassMethod(Class cls, SEL sel)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (!cls  ||  !sel) <span class="keyword">return</span> <span class="literal">nil</span>;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> class_getInstanceMethod(cls-&gt;getMeta(), sel);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¤§å®¶å¯ä»¥ä¸‹è½½ <a href="https://opensource.apple.com/tarballs/objc4/" target="_blank" rel="external">Runtime æºç </a> çœ‹çœ‹ã€‚</p>
<p>å…¶å®<code>class_getClassMethod</code>å†…å°±æ˜¯è°ƒäº†ä¸‹<code>class_getInstanceMethod</code>ï¼Œåªæ˜¯ä¼ çš„<code>Class</code>å‚æ•°ä¸ä¸€æ ·ï¼š</p>
<ul>
<li><code>class_getClassMethod</code> ä¸­<code>Class</code>å‚æ•°ä¼ çš„æ˜¯å…ƒç±»ï¼Œä¹Ÿå°±æ˜¯ç±»å¯¹è±¡çš„ç±»ã€‚ï¼ˆå…³äºå…ƒç±»å¤§å®¶å¯ä»¥çœ‹çœ‹è¿™ç¯‡ç¿»è¯‘çš„æ–‡ç«  <a href="http://ios.jobbole.com/81657/" target="_blank" rel="external">Objective-C ä¸­çš„å…ƒç±»ï¼ˆmeta classï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ</a>ï¼‰</li>
<li><code>class_getInstanceMethod</code>ä¸­<code>Class</code> å‚æ•°çœ‹åå­—å°±å¯ä»¥ç†è§£ï¼Œæ—¢ç„¶æ˜¯è·å¾—å®ä¾‹æ–¹æ³•ï¼Œè‡ªç„¶ä¼ çš„å°±æ˜¯å®ä¾‹å¯¹è±¡çš„ç±»ã€‚</li>
</ul>
<p>é‚£ <code>object_getClass(id obj)</code> åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¿˜æ˜¯çœ‹æºç ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Class object_getClass(<span class="keyword">id</span> obj)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (obj) <span class="keyword">return</span> obj-&gt;getIsa();</div><div class="line">    <span class="keyword">else</span> <span class="keyword">return</span> Nil;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>object_getClass()</code> å°±æ˜¯é¡ºç€ isa çš„æŒ‡å‘é“¾æ‰¾åˆ°å¯¹åº”çš„ç±»ã€‚</p>
<p>æœ‰å…´è¶£çš„å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href="http://ios.jobbole.com/91962/" target="_blank" rel="external">ä¸ºä»€ä¹ˆ object_getClass(obj) ä¸ [OBJ class] è¿”å›çš„æŒ‡é’ˆä¸åŒ</a></p>
<h4 id="é™æ€ï¼ˆç±»ï¼‰æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•é‡Œé¢çš„-self-è¡¨ç¤ºçš„å«ä¹‰ä¸€æ ·å—ï¼Ÿ"><a href="#é™æ€ï¼ˆç±»ï¼‰æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•é‡Œé¢çš„-self-è¡¨ç¤ºçš„å«ä¹‰ä¸€æ ·å—ï¼Ÿ" class="headerlink" title="é™æ€ï¼ˆç±»ï¼‰æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•é‡Œé¢çš„ self è¡¨ç¤ºçš„å«ä¹‰ä¸€æ ·å—ï¼Ÿ"></a>é™æ€ï¼ˆç±»ï¼‰æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•é‡Œé¢çš„ self è¡¨ç¤ºçš„å«ä¹‰ä¸€æ ·å—ï¼Ÿ</h4><p>å…ˆè¯´æ˜ä¸‹ä¸ºä»€ä¹ˆæˆ‘ä¼šçªç„¶æœ‰è¿™ä¸ªç–‘é—®ï¼š</p>
<p>å½“åˆä¸ºäº†æ–¹ä¾¿æµ‹è¯•äº¤æ¢ä¸¤ä¸ªé™æ€æ–¹æ³•çš„å®ç°ï¼Œæˆ‘ç›´æ¥æ’¸äº†è¿™ä¸€æ®µä»£ç ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    </div><div class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</div><div class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</div><div class="line">        SEL s1 = <span class="keyword">@selector</span>(test1);</div><div class="line">        SEL s2 = <span class="keyword">@selector</span>(test2);</div><div class="line">        Class <span class="keyword">class</span> = object_getClass((<span class="keyword">id</span>)<span class="keyword">self</span>);</div><div class="line">        Method m1 = class_getClassMethod(<span class="keyword">class</span>, s1);</div><div class="line">        Method m2 = class_getClassMethod(<span class="keyword">class</span>, s2);</div><div class="line">        <span class="built_in">BOOL</span> success = class_addMethod(<span class="keyword">class</span>, s1, method_getImplementation(m2), method_getTypeEncoding(m2));</div><div class="line">        <span class="keyword">if</span> (success)&#123;</div><div class="line">            class_replaceMethod(<span class="keyword">class</span>, s2, method_getImplementation(m1), method_getTypeEncoding(m1));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            method_exchangeImplementations(m1, m2);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    [ViewController test1];</div><div class="line">    [ViewController test2];</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)test1 &#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"test1"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)test2 &#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"test2"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‰“å°ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">2017-01-25 17:13:53.356 RuntimeDemo[16180:4689887] test1</div><div class="line">2017-01-25 17:13:53.356 RuntimeDemo[16180:4689887] test2</div></pre></td></tr></table></figure>
<p>å±…ç„¶äº¤æ¢å¤±è´¥äº†ï¼</p>
<p>ç„¶åæˆ‘å°è¯•ç€æŠŠä»£ç æŒªåˆ° <code>+ (void)load{}</code> é‡Œé¢ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">+ (void)load &#123;</div><div class="line">    static dispatch_once_t onceToken;</div><div class="line">    dispatch_once(&amp;onceToken, ^&#123;</div><div class="line">        SEL s1 = @selector(test1);</div><div class="line">        SEL s2 = @selector(test2);</div><div class="line">        Class class = object_getClass((id)self);</div><div class="line">        Method m1 = class_getClassMethod(class, s1);</div><div class="line">        Method m2 = class_getClassMethod(class, s2);</div><div class="line">        BOOL success = class_addMethod(class, s1, method_getImplementation(m2), method_getTypeEncoding(m2));</div><div class="line">        if (success)&#123;</div><div class="line">            class_replaceMethod(class, s2, method_getImplementation(m1), method_getTypeEncoding(m1));</div><div class="line">        &#125;</div><div class="line">        else&#123;</div><div class="line">            method_exchangeImplementations(m1, m2);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    [super viewDidLoad];</div><div class="line"></div><div class="line">    [ViewController test1];</div><div class="line">    [ViewController test2];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‰“å°ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">2017-01-25 17:23:32.739 RuntimeDemo[16212:4705811] test2</div><div class="line">2017-01-25 17:23:32.739 RuntimeDemo[16212:4705811] test1</div></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°äº¤æ¢æˆåŠŸäº†ï¼</p>
<p>åœ¨æ‰¾åŸå› ä¹‹å‰æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€å¼ ç»å…¸çš„å›¾ï¼š</p>
<p><img src="/images/011.png" alt=""></p>
<p>ä»å·¦åˆ°å³ä¾æ¬¡æ˜¯ï¼šå®ä¾‹å¯¹è±¡ã€ç±»å¯¹è±¡ã€å…ƒç±»ï¼ˆç±»å¯¹è±¡çš„ç±»ï¼‰ã€‚</p>
<p>æˆ‘ä»¬é€šå¸¸è¿™æ ·æ¥è·å–è¿™ä¸‰ä¸ªå¯¹è±¡ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Person *obj = [Person new];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"instance         :%p"</span>, obj);</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"class            :%p"</span>, object_getClass(obj));</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"meta class       :%p"</span>, object_getClass(object_getClass(obj)));</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æ¥å¤§èƒ†çŒœæƒ³ä¸‹ï¼š<strong>åœ¨å®ä¾‹æ–¹æ³•ä¸­ï¼Œ<code>self</code>è¡¨ç¤ºçš„æ˜¯å®ä¾‹å¯¹è±¡è¿™ä¸ªå¤§å®¶éƒ½çŸ¥é“ï¼Œé‚£åœ¨ç±»ï¼ˆé™æ€ï¼‰æ–¹æ³•ä¸­<code>self</code>è¡¨ç¤ºçš„æ˜¯ä¸æ˜¯å°±æ˜¯å®ä¾‹å¯¹è±¡çš„ç±»ï¼Œä¹Ÿå°±æ˜¯ç±»å¯¹è±¡å‘¢ï¼Ÿ</strong>æˆ‘ä»¬ç›´æ¥æ’¸ä»£ç æ¥éªŒè¯ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    </div><div class="line">    [<span class="keyword">self</span> test1];</div><div class="line">    [ViewController test2];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)test1 &#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%p"</span>,<span class="keyword">self</span>);</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%p"</span>,object_getClass((<span class="keyword">id</span>)<span class="keyword">self</span>));</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)test2 &#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%p"</span>,<span class="keyword">self</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‰“å°ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">2017-01-25 22:54:37.325 RuntimeDemo[3841:159827] 0x7ff6ee50ac00</div><div class="line">2017-01-25 22:54:38.752 RuntimeDemo[3841:159827] 0x100ec0fe0</div><div class="line">2017-01-25 22:54:42.740 RuntimeDemo[3841:159827] 0x100ec0fe0</div></pre></td></tr></table></figure>
<p>æœç„¶ä¸å‡ºæ‰€æ–™ï¼Œæˆ‘ä»¬çš„å¤§èƒ†çŒœæƒ³æ˜¯æ­£ç¡®çš„ã€‚</p>
<p>å›è¿‡å¤´ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸‹å®ä¾‹æ–¹æ³•ä¸­äº¤æ¢çš„å®ç°ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    </div><div class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</div><div class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</div><div class="line">       	Â·Â·Â·Â·</div><div class="line">       	</div><div class="line">       	Class <span class="keyword">class</span> = object_getClass(object_getClass((<span class="keyword">id</span>)<span class="keyword">self</span>));</div><div class="line">      </div><div class="line">      	Â·Â·Â·Â·</div><div class="line">       &#125;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    [ViewController test1];</div><div class="line">    [ViewController test2];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‰“å°ç»“æœä¹Ÿè‡ªç„¶è€Œç„¶çš„äº¤æ¢æˆåŠŸäº†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">2017-01-25 23:02:12.579 RuntimeDemo[3926:164600] test2</div><div class="line">2017-01-25 23:02:12.580 RuntimeDemo[3926:164600] test1</div></pre></td></tr></table></figure>
<h4 id="ç½‘ä¸Šçš„-Method-Swizzling-æœ‰ä¸¤ç§å†™æ³•ï¼Œåˆ°åº•å“ªç§é è°±ï¼Ÿ"><a href="#ç½‘ä¸Šçš„-Method-Swizzling-æœ‰ä¸¤ç§å†™æ³•ï¼Œåˆ°åº•å“ªç§é è°±ï¼Ÿ" class="headerlink" title="ç½‘ä¸Šçš„ Method Swizzling æœ‰ä¸¤ç§å†™æ³•ï¼Œåˆ°åº•å“ªç§é è°±ï¼Ÿ"></a>ç½‘ä¸Šçš„ Method Swizzling æœ‰ä¸¤ç§å†™æ³•ï¼Œåˆ°åº•å“ªç§é è°±ï¼Ÿ</h4><p>ä¸¤ç§å†™æ³•åˆ†åˆ«å¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">+ (<span class="keyword">void</span>)load &#123;</div><div class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</div><div class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</div><div class="line">        SEL s1 = <span class="keyword">@selector</span>(go);</div><div class="line">        SEL s2 = <span class="keyword">@selector</span>(stop);</div><div class="line">        Class <span class="keyword">class</span> = object_getClass((<span class="keyword">id</span>)<span class="keyword">self</span>);</div><div class="line">        Method m1 = class_getClassMethod(<span class="keyword">class</span>, s1);</div><div class="line">        Method m2 = class_getClassMethod(<span class="keyword">class</span>, s2);</div><div class="line">        <span class="built_in">BOOL</span> success = class_addMethod(<span class="keyword">class</span>, s1, method_getImplementation(m2), method_getTypeEncoding(m2));</div><div class="line">        <span class="keyword">if</span> (success)&#123;</div><div class="line">            class_replaceMethod(<span class="keyword">class</span>, s2, method_getImplementation(m1), method_getTypeEncoding(m1));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            method_exchangeImplementations(m1, m2);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">+ (<span class="keyword">void</span>)load &#123;</div><div class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</div><div class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</div><div class="line">        SEL s1 = <span class="keyword">@selector</span>(go);</div><div class="line">        SEL s2 = <span class="keyword">@selector</span>(stop);</div><div class="line">        Class <span class="keyword">class</span> = object_getClass((<span class="keyword">id</span>)<span class="keyword">self</span>);</div><div class="line">        Method m1 = class_getClassMethod(<span class="keyword">class</span>, s1);</div><div class="line">        Method m2 = class_getClassMethod(<span class="keyword">class</span>, s2);</div><div class="line">        method_exchangeImplementations(m1, m2);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç¬¬ä¸€ç§å¤šäº†ä¸ªåˆ¤æ–­ï¼Œç¬¬äºŒç§æ˜¯ç›´æ¥äº¤æ¢ã€‚</p>
<p>æ–‡ç« ä¸€å¼€å§‹ä¹Ÿè¯´äº†ï¼Œç¬¬ä¸€ç§æ˜¯æ¯”è¾ƒä¸¥è°¨çš„å†™æ³•ï¼›è€Œç¬¬äºŒç§ï¼Œ<strong>å½“æˆ‘ä»¬æƒ³äº¤æ¢æœ‰å¤šä¸ªç»§æ‰¿å…³ç³»çš„å­ç±»é‡Œé¢çš„æ–¹æ³•å¹¶ä¸”å­ç±»æ²¡æœ‰å®ç°çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œç›´æ¥<code>method_exchangeImplementations</code>ä¼šæŠŠçˆ¶ç±»çš„æ–¹æ³•ä¹Ÿç»™äº¤æ¢äº†</strong>ï¼Œä¸€èˆ¬è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼Œä¸‹é¢æˆ‘ä»¬ç›´æ¥æ’¸ä»£ç æ¥éªŒè¯ä¸‹ï¼š</p>
<p>çˆ¶ç±» Person</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">.h</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Person</span> : <span class="title">NSObject</span></span></div><div class="line"><span class="comment">//é™æ€(ç±») æ–¹æ³•</span></div><div class="line">+ (<span class="keyword">void</span>)go;</div><div class="line">+ (<span class="keyword">void</span>)stop;</div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line">.m</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Person</span></span></div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)go &#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"Go!"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)stop &#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"Stop!"</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>å­ç±» Programmer</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">.h</div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"Person.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Programmer</span> : <span class="title">Person</span></span></div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line">.m</div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"Programmer.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Programmer</span></span></div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)load &#123;</div><div class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</div><div class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</div><div class="line">        SEL s1 = <span class="keyword">@selector</span>(go);</div><div class="line">        SEL s2 = <span class="keyword">@selector</span>(stop);</div><div class="line">        Class <span class="keyword">class</span> = object_getClass((<span class="keyword">id</span>)<span class="keyword">self</span>);</div><div class="line">        Method m1 = class_getClassMethod(<span class="keyword">class</span>, s1);</div><div class="line">        Method m2 = class_getClassMethod(<span class="keyword">class</span>, s2);</div><div class="line">        method_exchangeImplementations(m1, m2);</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//+ (void)go &#123;</span></div><div class="line"><span class="comment">//    NSLog(@"Programmer - go");</span></div><div class="line"><span class="comment">//&#125;</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//+ (void)stop &#123;</span></div><div class="line"><span class="comment">//    NSLog(@"Programmer - stop");</span></div><div class="line"><span class="comment">//&#125;</span></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>è°ƒç”¨</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    </div><div class="line">    [Person go];</div><div class="line">    [Person stop];</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---------"</span>);</div><div class="line">    [Programmer go];</div><div class="line">    [Programmer stop];</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åªå®ç°çˆ¶ç±»çš„ <code>go</code> å’Œ <code>stop</code> è¿™ä¸¤ä¸ªé™æ€æ–¹æ³•ï¼Œæ‰“å°å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">2017-01-25 23:30:12.850 RuntimeDemo[4180:180408] Stop!</div><div class="line">2017-01-25 23:30:12.851 RuntimeDemo[4180:180408] Go!</div><div class="line">2017-01-25 23:30:12.851 RuntimeDemo[4180:180408] ---------</div><div class="line">2017-01-25 23:30:12.851 RuntimeDemo[4180:180408] Stop!</div><div class="line">2017-01-25 23:30:12.852 RuntimeDemo[4180:180408] Go!</div></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°ï¼Œ<strong>å­ç±»<code>Programmer</code>æ²¡æœ‰å®ç°çˆ¶ç±»çš„æ–¹æ³•ç›´æ¥äº¤æ¢æ—¶ï¼Œ çˆ¶ç±»<code>Person</code>çš„æ–¹æ³•ä¹Ÿè¢«äº¤æ¢äº†ï¼</strong></p>
<p>æˆ‘ä»¬æ¥ç€æ‰“å¼€å­ç±»çš„ <code>go</code> å’Œ <code>stop</code> è¿™ä¸¤ä¸ªé™æ€æ–¹æ³•ï¼Œæ‰“å°å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">2017-01-25 23:32:22.953 RuntimeDemo[4215:181987] Go!</div><div class="line">2017-01-25 23:32:22.954 RuntimeDemo[4215:181987] Stop!</div><div class="line">2017-01-25 23:32:22.956 RuntimeDemo[4215:181987] ---------</div><div class="line">2017-01-25 23:32:22.956 RuntimeDemo[4215:181987] Programmer - stop</div><div class="line">2017-01-25 23:32:22.956 RuntimeDemo[4215:181987] Programmer - go</div></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°ï¼Œ<strong>å­ç±»å®ç°äº†çˆ¶ç±»çš„æ–¹æ³•ï¼Œç›´æ¥äº¤æ¢ä¹Ÿæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼</strong></p>
<p>æˆ‘ä»¬åŠ ä¸Šåˆ¤æ–­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">+ (void)load &#123;</div><div class="line">    static dispatch_once_t onceToken;</div><div class="line">    dispatch_once(&amp;onceToken, ^&#123;</div><div class="line">        ...</div><div class="line">        </div><div class="line">        BOOL success =  class_addMethod(class, s1, method_getImplementation(m2), method_getTypeEncoding(m2));</div><div class="line">        if (success)&#123;</div><div class="line">            class_replaceMethod(class, s2, method_getImplementation(m1), method_getTypeEncoding(m1));</div><div class="line">        &#125;else&#123;</div><div class="line">            method_exchangeImplementations(m1, m2);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        ...</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æŠŠä¸Šé¢ä¸¤ç§æƒ…å†µåœ¨è¯•éªŒä¸‹ï¼Œå¯ä»¥å‘ç°<strong>äº¤æ¢çš„ä»…ä»…æ˜¯å­ç±»<code>Programmer</code>çš„æ–¹æ³•ï¼Œçˆ¶ç±»<code>Person</code>æ˜¯æ²¡æœ‰è¢«äº¤æ¢çš„ï¼</strong>å¤§å®¶å¯ä»¥è‡ªå·±å°è¯•ä¸‹ã€‚</p>
<p>ç¨ç¨çš„è§£é‡Šä¸‹ï¼š</p>
<p><code>class_addMethod</code>å‡½æ•°ä¼šæ£€æŸ¥æ–¹æ³•æœ‰æ²¡æœ‰å®ç°ï¼Œå¦‚æœå·²ç»å®ç°ä¼šè¿”å› NO ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥èµ°<code>method_exchangeImplementations</code>æ–¹æ³•ï¼›æ²¡æœ‰å®ç°ä¼šå…ˆåœ¨å½“å‰ç±»å¢åŠ ä¸€ä¸ªæ–°çš„å®ç°æ–¹æ³•ï¼Œå†æŠŠç›®æ ‡ç±»ä¸­çš„æ–¹æ³•é€šè¿‡<code>class_replaceMethod</code>å‡½æ•°æ›¿æ¢ä¸ºæ—§æœ‰çš„å®ç°ï¼›</p>
<h4 id="ç»“å°¾"><a href="#ç»“å°¾" class="headerlink" title="ç»“å°¾"></a>ç»“å°¾</h4><p>ä»¥ä¸Šå°±æ˜¯æˆ‘é‡åˆ°çš„é—®é¢˜ï¼Œå¸Œæœ›å¯¹å¤§å®¶èƒ½æœ‰ç‚¹å¸®åŠ©ã€‚æœ€åä¹Ÿå¸Œæœ›å¤§å®¶èƒ½å¤Ÿäº²è‡ªåŠ¨æ‰‹æ•²ä¸€éï¼ŒåŠ æ·±ä¸‹å°è±¡ã€‚</p>
<p>å‚è€ƒé“¾æ¥</p>
<p><a href="http://ios.jobbole.com/91962/" target="_blank" rel="external">http://ios.jobbole.com/91962/</a></p>
<p><a href="http://ios.jobbole.com/81657/" target="_blank" rel="external">http://ios.jobbole.com/81657/</a></p>
<p><a href="http://blog.csdn.net/horkychen/article/details/8532087" target="_blank" rel="external">http://blog.csdn.net/horkychen/article/details/8532087</a></p>


                
            </div>


            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    




                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

                <ul class="list-inline text-center">
                    

                    

                    

                    

                    

                    

                    
                </ul>
                <p class="copyright text-muted">Get busy living, or get busy dying~ <br>Copyright &copy; Hexo-CleanBlog 2016-2018 <br></p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>

<!-- Bootstrap -->
<script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdn.bootcss.com/featherlight/1.7.1/featherlight.gallery.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>
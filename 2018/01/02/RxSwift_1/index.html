<!DOCTYPE html>
<html lang="zh-cn">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="环境：

Xcode 9.1Swift 4.0RxSwift 4.0                                                                                                                    ">
    

    <!--Author-->
    
        <meta name="author" content="ifelseboyxx">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="RxSwift 入坑-需要知道的基础概念"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="ifelseboyxx&#39;s Blog"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

        <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>RxSwift 入坑-需要知道的基础概念 - ifelseboyxx&#39;s Blog</title>

    <!-- Bootstrap Core CSS -->
    <link href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdn.bootcss.com/featherlight/1.7.1/featherlight.min.css" type="text/css" rel="stylesheet">

    <!-- Google Analytics -->
    


    <!-- favicon -->
    
    <link rel="icon" href="/img/red.png">
    
	
</head>


<body>

    <!-- Menu -->
    
        <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">ifelseboyxx {"🤢"}</a>

        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    
                        <li class="previous" title="">
                            <a href="/2018/01/08/objc_xx/">&larr; Prev</a>
                        </li>
                    
                </li>
                <li>
                    
                        <li class="next" title="Swift 知识小集">
                            <a href="/2017/12/07/swift-tips/">Next  &rarr;</a>
                        </li>
                    
                </li>

                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/ifelseboyxx">
                            
                                GitHub
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://juejin.im/user/5a421a5ef265da4320038046">
                            
                                掘金
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
    

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->


<header class="intro-header">
    <div class="container">
    </div>
</header>


<div class="container">
    <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-preview">
                <!-- Title -->
                <a href="/2018/01/02/RxSwift_1/">
                    <h2 class="post-title">
                        RxSwift 入坑-需要知道的基础概念
                    </h2>
                </a>

                <!-- Tags -->
                
                  
                        <a href="/tags/RxSwift/" rel="tag" class="post-tag">
                        RxSwift
                      </a>
                  
                

                <p class="post-meta">
                    <!-- Date and Author -->
                    
                    2018-01-02
                </p>
            </div>
            <hr>
        </div>
    </div>
</div>


<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>环境：</p>
<blockquote>
<p>Xcode 9.1<br>Swift 4.0<br>RxSwift 4.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </p>
</blockquote>
<p>目录：</p>
<blockquote>
<p><a href="#1.0">什么是 RxSwift</a><br><a href="#1.1">响应式编程</a><br><a href="#1.2">RxSwift 核心概念</a><br><a href="#1.3">Hot and Cold Observables</a></p>
</blockquote>
<h2 id="1.0"> 什么是 RxSwift </h2>

<p><a href="https://github.com/ReactiveX/RxSwift" target="_blank" rel="external">RxSwift</a> 是 <a href="http://reactivex.io/" target="_blank" rel="external">ReactiveX</a> 的 Swift 版本，全称 Reactive Extensions Swift，是一个响应式编程的基础框架。</p>
<h2 id="1.1"> 响应式编程 </h2>

<p>在面向对象时代，大多数程序都像这样运行：你的代码告诉你的程序需要做什么，并且有很多方法来监听变化–但同时你又必须主动告诉系统什么时候发生的变化。</p>
<p>响应式编程的基本思想是：你的程序可以对底层数据的变化做出响应，而不需要你直接告诉它。这样，你可以更专注于所需要处理的业务逻辑，而不需要去维护特定的状态。</p>
<p>举个简单的例子：</p>
<blockquote>
<p>a ＝ b ＋ c<br>赋值之后 b 或者 c 的值变化后，a 的值不会跟着变化<br>响应式编程，目标就是，如果 b 或者 c 的数值发生变化，a 的数值会同时发生变化；</p>
</blockquote>
<p>另外推荐看看这篇 <a href="http://blog.mrriddler.com/" target="_blank" rel="external">iOS 响应式架构</a></p>
<h2 id="1.2"> RxSwift 的核心 </h2>

<p>RxSwift 核心概念就是一个观察者（Observer）订阅一个可被观察序列（Observable）。观察者对可被观察序列发射的数据或数据序列作出响应。</p>
<p>举个简单的例子，当别人在跟你说话时，你就是那个观察者（Observer），别人就是那个（Observable），它有几个特点：</p>
<ul>
<li>可能会不断地跟你说话。（<code>onNext</code>）</li>
<li>可能会说错话。（<code>onError</code>）</li>
<li>结束说话。（<code>onCompleted</code>）</li>
</ul>
<p>你在听到对方说的话后，也可以有几种反应：</p>
<ul>
<li>根据说的话，做相应的事，比如对方让你借钱给他。（<code>subscribe</code>）</li>
<li>把对方说的话，加工下再传达给其他人，比如对方说小李好像不太舒服，你传达给其他人时就变成了小李失恋了。（<code>map:</code>）</li>
<li>参考其他人说的话再做处理，比如小李说某家店很好吃，小黄说某家店一般般，你需要结合两个人的意见再做定夺。（<code>zip:</code>）</li>
</ul>
<h3 id="Observable-可被观察的序列"><a href="#Observable-可被观察的序列" class="headerlink" title="Observable - 可被观察的序列"></a>Observable - 可被观察的序列</h3><h4 id="Observable-的三种事件"><a href="#Observable-的三种事件" class="headerlink" title="Observable 的三种事件"></a>Observable 的三种事件</h4><ul>
<li>next - 序列产生了一个新的元素</li>
<li>error - 创建序列时产生了一个错误，导致序列终止</li>
<li>completed - 序列的所有元素都已经成功产生，整个序列已经完成</li>
</ul>
<h4 id="基本创建方式"><a href="#基本创建方式" class="headerlink" title="基本创建方式"></a>基本创建方式</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">MyError</span>: <span class="title">Error</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> anError</div><div class="line">&#125;</div><div class="line">        </div><div class="line"><span class="keyword">let</span> message: <span class="type">Observable</span>&lt;<span class="type">String</span>&gt; = <span class="type">Observable</span>&lt;<span class="type">String</span>&gt;.create &#123; (observer) -&gt; <span class="type">Disposable</span> <span class="keyword">in</span></div><div class="line">            </div><div class="line">    observer.onNext(<span class="string">"😄"</span>)</div><div class="line">    observer.onError(<span class="type">MyError</span>.anError)</div><div class="line">    observer.onCompleted()</div><div class="line">        </div><div class="line">    <span class="keyword">return</span> <span class="type">Disposables</span>.create()</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h4 id="封装好操作符创建方式"><a href="#封装好操作符创建方式" class="headerlink" title="封装好操作符创建方式"></a>封装好操作符创建方式</h4><ul>
<li>just - 将某一个元素转换为 <code>Observable</code> 并发出唯一的一个元素</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> id = <span class="type">Observable</span>.just(<span class="number">0</span>)</div><div class="line"></div><div class="line">相当于：</div><div class="line"></div><div class="line"><span class="keyword">let</span> id = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.create &#123; observer <span class="keyword">in</span></div><div class="line">    observer.onNext(<span class="number">0</span>)</div><div class="line">    observer.onCompleted()</div><div class="line">    <span class="keyword">return</span> <span class="type">Disposables</span>.create()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>from - 将其他类型或者数据结构转换为 <code>Observable</code> </li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">将一个数组转换为 <span class="type">Observable</span>：</div><div class="line"></div><div class="line"><span class="keyword">let</span> numbers = <span class="type">Observable</span>.from([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>])</div><div class="line"></div><div class="line">相当于：</div><div class="line"></div><div class="line"><span class="keyword">let</span> numbers = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.create &#123; observer <span class="keyword">in</span></div><div class="line">    observer.onNext(<span class="number">0</span>)</div><div class="line">    observer.onNext(<span class="number">1</span>)</div><div class="line">    observer.onNext(<span class="number">2</span>)</div><div class="line">    observer.onCompleted()</div><div class="line">    <span class="keyword">return</span> <span class="type">Disposables</span>.create()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>具体更多的操作符，大家可以看看这个文档的 <a href="https://beeth0ven.github.io/RxSwift-Chinese-Documentation/content/decision_tree.html" target="_blank" rel="external">如何选择操作符？</a>。也可以看看官方示例里的 <code>playground</code> ：<a href="https://github.com/ReactiveX/RxSwift/tree/master/Rx.playground" target="_blank" rel="external">Rx.playground</a></p>
<h3 id="Observer-观察者"><a href="#Observer-观察者" class="headerlink" title="Observer - 观察者"></a>Observer - 观察者</h3><h4 id="基本创建方式-1"><a href="#基本创建方式-1" class="headerlink" title="基本创建方式"></a>基本创建方式</h4><p>理解观察者的意思后，那我们如何创建呢？对应 Observable 一节中的 “基本创建方式”，我们可以为 <code>message: Observable&lt;String&gt;</code> 创建一个观察者：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">message.subscribe(onNext: &#123; str <span class="keyword">in</span></div><div class="line">        <span class="built_in">print</span>(<span class="string">"观察信息"</span>)</div><div class="line">    &#125;, onError: &#123; error <span class="keyword">in</span></div><div class="line">        <span class="built_in">print</span>(<span class="string">"发生错误"</span>)</div><div class="line">    &#125;, onCompleted: &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"完成"</span>)</div><div class="line">&#125;).dispose()</div></pre></td></tr></table></figure>
<p>创建观察者最直接的方法就是在 <code>Observable</code> 的 <code>subscribe</code> 方法后面描述，事件发生时，需要如何做出响应。而观察者就是由后面的 <code>onNext</code>，<code>onError</code>，<code>onCompleted</code> 的这些闭包构建出来的。</p>
<h4 id="一些封装"><a href="#一些封装" class="headerlink" title="一些封装"></a>一些封装</h4><p>RxSwift 也帮我们封装了很多许多常用的观察者（Observer），比如 <code>button</code> 的点击，通知以及代理等等。</p>
<p>我们先导入头文件：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> RxCocoa</div></pre></td></tr></table></figure>
<p>原先监听按钮点击需要这么做：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line">    </div><div class="line">        <span class="keyword">let</span> btn = <span class="type">UIButton</span>.<span class="keyword">init</span>(frame: <span class="type">CGRect</span>(x: <span class="number">100</span>, y: <span class="number">100</span>, width: <span class="number">150</span>, height: <span class="number">50</span>))</div><div class="line">        btn.backgroundColor = <span class="type">UIColor</span>.brown</div><div class="line">        btn.addTarget(<span class="keyword">self</span>, action: #selector(btnClick), <span class="keyword">for</span>: .touchUpInside)</div><div class="line">        view.addSubview(btn)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// 回调监听</span></div><div class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">btnClick</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"btn click !"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>用 RxSwift 我们可以这么做：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> disposeBag = <span class="type">DisposeBag</span>()</div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line">        </div><div class="line">        <span class="keyword">let</span> btn = <span class="type">UIButton</span>.<span class="keyword">init</span>(frame: <span class="type">CGRect</span>(x: <span class="number">100</span>, y: <span class="number">100</span>, width: <span class="number">150</span>, height: <span class="number">50</span>))</div><div class="line">        btn.backgroundColor = <span class="type">UIColor</span>.brown</div><div class="line">        view.addSubview(btn)</div><div class="line">        </div><div class="line">        <span class="comment">// 回调监听</span></div><div class="line">        btn.rx.tap.subscribe(onNext: &#123;</div><div class="line">    </div><div class="line">            <span class="built_in">print</span>(<span class="string">"btn click !"</span>)</div><div class="line">            </div><div class="line">        &#125;).disposed(by: disposeBag)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>再看看代理，原先我们需要这么做：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> textView: <span class="type">UITextView</span>!</div><div class="line"></div><div class="line">    <span class="keyword">var</span> disposeBag = <span class="type">DisposeBag</span>()</div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line">        <span class="comment">// 设置代理</span></div><div class="line">        textView.delegate = <span class="keyword">self</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIViewController</span>: <span class="title">UITextViewDelegate</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">scrollViewDidScroll</span><span class="params">(<span class="number">_</span> scrollView: UIScrollView)</span></span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"y坐标：\(offset.y)"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>用 RxSwift 我们可以这么做：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> textView: <span class="type">UITextView</span>!</div><div class="line"></div><div class="line">    <span class="keyword">var</span> disposeBag = <span class="type">DisposeBag</span>()</div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line">        </div><div class="line">        textView.rx.contentOffset.subscribe(onNext: &#123; offset <span class="keyword">in</span></div><div class="line">            </div><div class="line">            <span class="built_in">print</span>(<span class="string">"y坐标：\(offset.y)"</span>)</div><div class="line">            </div><div class="line">        &#125;).disposed(by: disposeBag)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>可以发现，RxSwift 使一些系统的方法，使用上变得更加方便。</p>
<h3 id="Subjects-既是可被监听的序列也是观察者"><a href="#Subjects-既是可被监听的序列也是观察者" class="headerlink" title="Subjects - 既是可被监听的序列也是观察者"></a>Subjects - 既是可被监听的序列也是观察者</h3><p>Subject 是 observable 和 Observer 之间的桥梁。一个 Subject 既是一个 Obserable 也是一个 Observer，既可以发出事件，也可以监听事件。</p>
<p>例如：<code>UITextField</code> 的当前文本。它可以看成是由用户输入，而产生的一个文本序列。也可以是由外部文本序列，来控制当前显示内容的观察者：</p>
<ul>
<li>作为可被监听的序列（<code>observable</code>）</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> tf: <span class="type">UITextField</span>!</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> disposeBag = <span class="type">DisposeBag</span>()</div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line">        </div><div class="line">        <span class="comment">// 作为可被监听的序列</span></div><div class="line">        <span class="keyword">let</span> observable_tf = tf.rx.text</div><div class="line">    </div><div class="line">        observable_tf.subscribe(onNext:&#123; text <span class="keyword">in</span></div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> t = text &#123;</div><div class="line">                <span class="type">DebugPrint</span>(t)</div><div class="line">            &#125;</div><div class="line">        &#125;).disposed(by: disposeBag)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>作为观察者（<code>Observer</code>）</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> tf: <span class="type">UITextField</span>!</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> disposeBag = <span class="type">DisposeBag</span>()</div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line">                </div><div class="line">        <span class="comment">// 作为观察者</span></div><div class="line">        <span class="keyword">let</span> observer_tf = tf.rx.text</div><div class="line">        <span class="keyword">let</span> text: <span class="type">Observable</span>&lt;<span class="type">String</span>?&gt; = <span class="type">Observable</span>.just(<span class="string">"Atom."</span>)</div><div class="line">        </div><div class="line">        text.bind(to: observer_tf).disposed(by: disposeBag)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>RxSwift 中也定义了一些辅助类型，它们既是可被监听的序列也是观察者。这里就不多讲了，具体可以看看这里 <a href="https://beeth0ven.github.io/RxSwift-Chinese-Documentation/content/rxswift_core/observable_and_observer.html" target="_blank" rel="external">Observable &amp; Observer 既是可被监听的序列也是观察者</a>。</p>
<h3 id="Disposable-可被清除的资源"><a href="#Disposable-可被清除的资源" class="headerlink" title="Disposable - 可被清除的资源"></a>Disposable - 可被清除的资源</h3><p>当监听一个事件序列的时候，有消息事件来了，我们做某些事情。但是这个事件序列不再发出消息了，我们的监听也就没有什么存在价值了，为了不消耗内存，需要释放这些监听资源。</p>
<p>一个 Observable 被观察订阅后，就会产生一个 <code>Disposable</code> 实例，表示「可扔掉」的，怎么扔掉呢？有下面几种方式：</p>
<ul>
<li>调用 <code>dispose()</code> 显式释放</li>
<li>通过 DisposeBag 也就是 <code>disposed()</code> 隐式释放。</li>
<li>利用 <code>takeUntil</code> 操作符，隐式释放。</li>
</ul>
<h4 id="Dispose"><a href="#Dispose" class="headerlink" title="Dispose"></a>Dispose</h4><p>我们直接看个 🌰 ：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line">    </div><div class="line">        <span class="keyword">let</span> subscription = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.interval(<span class="number">1.0</span>, scheduler: <span class="type">SerialDispatchQueueScheduler</span>.<span class="keyword">init</span>(internalSerialQueueName: <span class="string">"serial"</span>))</div><div class="line">            .subscribe &#123; event <span class="keyword">in</span></div><div class="line">                <span class="built_in">print</span>(<span class="string">"\(event)"</span>)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="type">Thread</span>.sleep(forTimeInterval: <span class="number">4.0</span>)</div><div class="line">        </div><div class="line">        <span class="type">DebugPrint</span>(<span class="string">"手动释放"</span>)</div><div class="line">        subscription.dispose()</div><div class="line">    </div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 输出：</span></div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">16</span>:<span class="number">47</span>:<span class="number">49</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">39</span>]：next(<span class="number">0</span>)</div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">16</span>:<span class="number">47</span>:<span class="number">50</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">39</span>]：next(<span class="number">1</span>)</div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">16</span>:<span class="number">47</span>:<span class="number">51</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">39</span>]：next(<span class="number">2</span>)</div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">16</span>:<span class="number">47</span>:<span class="number">52</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">39</span>]：next(<span class="number">3</span>)</div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">16</span>:<span class="number">47</span>:<span class="number">52</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">44</span>]：手动释放</div></pre></td></tr></table></figure>
<p>上面的例子类似定时器，每秒会调一次回调。我们 <code>sleep</code> 4 秒后，调下 <code>dispose()</code>，可以发现回调就停止了，因为这个订阅被释放了。</p>
<blockquote>
<p><code>dispose()</code> 这种显示释放资源的方式一般不推荐，下面介绍的 DisposeBag 是比较推荐的方式！</p>
</blockquote>
<h4 id="DisposeBag"><a href="#DisposeBag" class="headerlink" title="DisposeBag"></a>DisposeBag</h4><p>DisposeBag 是比较推荐的方式。看名字也很好理解 -「处理袋」，把需要释放的 <code>Disposable</code> 实例，扔到袋子里。在袋子被回收（<code>deinit</code>）时，会顺便执行一下 <code>Disposable.dispose()</code>，之前创建 <code>Disposable</code> 时申请的资源就会被一并释放掉。听起来有点像 ARC。不过在创建这个「处理袋」时，我们需要保证它不那么快被释放掉，所以一般都是声明成实例的成员变量，和实例绑定起来，实例销毁，它也就销毁。我们具体来看个 🌰：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewControllerTwo</span>: <span class="title">UIViewController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">// 创建「处理袋，声明成实例的成员变量</span></div><div class="line">    <span class="keyword">var</span> disposeBag = <span class="type">DisposeBag</span>()</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line"></div><div class="line">        <span class="keyword">let</span> subscription = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.interval(<span class="number">1.0</span>, scheduler: <span class="type">SerialDispatchQueueScheduler</span>.<span class="keyword">init</span>(internalSerialQueueName: <span class="string">"haha"</span>))</div><div class="line">            .subscribe &#123; event <span class="keyword">in</span></div><div class="line">                <span class="type">DebugPrint</span>(<span class="string">"\(event)"</span>)</div><div class="line">        &#125;</div><div class="line">        subscription.disposed(by: disposeBag)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">deinit</span> &#123;</div><div class="line">        <span class="type">DebugPrint</span>(<span class="string">"释放了"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 输出：</span></div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">17</span>:<span class="number">57</span>:<span class="number">03</span> <span class="type">ViewControllerTwo</span>.swift viewDidLoad() <span class="number">23</span>]：next(<span class="number">0</span>)</div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">17</span>:<span class="number">57</span>:<span class="number">04</span> <span class="type">ViewControllerTwo</span>.swift viewDidLoad() <span class="number">23</span>]：next(<span class="number">1</span>)</div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">17</span>:<span class="number">57</span>:<span class="number">05</span> <span class="type">ViewControllerTwo</span>.swift viewDidLoad() <span class="number">23</span>]：next(<span class="number">2</span>)</div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">17</span>:<span class="number">57</span>:<span class="number">06</span> <span class="type">ViewControllerTwo</span>.swift viewDidLoad() <span class="number">23</span>]：next(<span class="number">3</span>)</div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">17</span>:<span class="number">57</span>:<span class="number">07</span> <span class="type">ViewControllerTwo</span>.swift viewDidLoad() <span class="number">23</span>]：next(<span class="number">4</span>)</div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">17</span>:<span class="number">57</span>:<span class="number">08</span> <span class="type">ViewControllerTwo</span>.swift <span class="keyword">deinit</span> <span class="number">29</span>]：释放了</div></pre></td></tr></table></figure>
<p>可以发现，在 <code>ViewControllerTwo</code> 释放（<code>deinit</code>）后，回调也停止了！</p>
<h4 id="takeUntil"><a href="#takeUntil" class="headerlink" title="takeUntil"></a>takeUntil</h4><p>我们还可以利用 <code>takeUntil</code> 操作符，把订阅绑定在 <code>deallocated</code>，来实现自动清理。我们直接看 🌰：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewControllerTwo</span>: <span class="title">UIViewController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line"></div><div class="line">        <span class="number">_</span> = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;</div><div class="line">            .interval(<span class="number">1.0</span>, scheduler: <span class="type">SerialDispatchQueueScheduler</span>.<span class="keyword">init</span>(internalSerialQueueName: <span class="string">"haha"</span>))</div><div class="line">            .takeUntil(<span class="keyword">self</span>.rx.deallocated) <span class="comment">// 绑定 deallocated</span></div><div class="line">            .subscribe &#123; event <span class="keyword">in</span></div><div class="line">                <span class="type">DebugPrint</span>(<span class="string">"\(event)"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">deinit</span> &#123;</div><div class="line">        <span class="type">DebugPrint</span>(<span class="string">"释放了"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 输出：</span></div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">29</span> <span class="type">ViewControllerTwo</span>.swift viewDidLoad() <span class="number">22</span>]：next(<span class="number">0</span>)</div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">30</span> <span class="type">ViewControllerTwo</span>.swift viewDidLoad() <span class="number">22</span>]：next(<span class="number">1</span>)</div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">31</span> <span class="type">ViewControllerTwo</span>.swift viewDidLoad() <span class="number">22</span>]：next(<span class="number">2</span>)</div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">32</span> <span class="type">ViewControllerTwo</span>.swift viewDidLoad() <span class="number">22</span>]：next(<span class="number">3</span>)</div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">33</span> <span class="type">ViewControllerTwo</span>.swift viewDidLoad() <span class="number">22</span>]：next(<span class="number">4</span>)</div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">34</span> <span class="type">ViewControllerTwo</span>.swift viewDidLoad() <span class="number">22</span>]：next(<span class="number">5</span>)</div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">35</span> <span class="type">ViewControllerTwo</span>.swift <span class="keyword">deinit</span> <span class="number">27</span>]：释放了</div><div class="line">[<span class="number">2017</span>-<span class="number">12</span>-<span class="number">29</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">35</span> <span class="type">ViewControllerTwo</span>.swift viewDidLoad() <span class="number">22</span>]：completed</div></pre></td></tr></table></figure>
<p>可以发现在 <code>ViewControllerTwo</code> 释放（<code>deinit</code>）后，回调也停止了！</p>
<h2 id="1.3"> Hot and Cold Observables </h2>

<h3 id="Cold-Observables"><a href="#Cold-Observables" class="headerlink" title="Cold Observables"></a>Cold Observables</h3><p>只有在被订阅的时候才会发射事件。每次有新的订阅者都会把之前所有的事件都重新发射一遍，换句话说，每个订阅者都会独立的收到订阅者发射的数据。</p>
<p>举个 🌰 ：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">let</span> intSequence = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.create &#123; (observer) -&gt; <span class="type">Disposable</span> <span class="keyword">in</span></div><div class="line"></div><div class="line">        observer.onNext(<span class="number">1</span>)</div><div class="line">        observer.onNext(<span class="number">2</span>)</div><div class="line">        observer.onNext(<span class="number">3</span>)</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> <span class="type">Disposables</span>.create()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面的 <code>Observable</code> 在没订阅之前，<code>create</code> 是不会被执行的。当我们订阅时才会执行：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">intSequence.subscribe(onNext:&#123; value <span class="keyword">in</span></div><div class="line">            </div><div class="line">    <span class="type">DebugPrint</span>(<span class="string">"subscribe1 : \(value)"</span>);</div><div class="line">            </div><div class="line">&#125;).disposed(by: disposeBag)</div><div class="line"></div><div class="line"><span class="comment">// 输出：</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">17</span>:<span class="number">05</span>:<span class="number">24</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">76</span>]：subscribe1 : <span class="number">1</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">17</span>:<span class="number">05</span>:<span class="number">24</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">76</span>]：subscribe1 : <span class="number">2</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">17</span>:<span class="number">05</span>:<span class="number">24</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">76</span>]：subscribe1 : <span class="number">3</span></div></pre></td></tr></table></figure>
<p>如果我们接着上面的代码再多添加几个订阅：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">2</span>...<span class="number">4</span> &#123;</div><div class="line">    <span class="comment">// 第三个订阅延迟两秒</span></div><div class="line">    <span class="keyword">if</span> i == <span class="number">3</span> &#123;</div><div class="line">        <span class="type">DispatchQueue</span>.main.asyncAfter(deadline: <span class="type">DispatchTime</span>.now() + <span class="number">2</span>, execute: &#123;</div><div class="line">            intSequence.subscribe(onNext:&#123; value <span class="keyword">in</span></div><div class="line">                </div><div class="line">                <span class="type">DebugPrint</span>(<span class="string">"subscribe\(i) : \(value)"</span>)</div><div class="line">                </div><div class="line">            &#125;).disposed(by: <span class="keyword">self</span>.disposeBag)</div><div class="line">        &#125;)</div><div class="line">        <span class="keyword">continue</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    intSequence.subscribe(onNext:&#123; value <span class="keyword">in</span></div><div class="line">        </div><div class="line">        <span class="type">DebugPrint</span>(<span class="string">"subscribe\(i) : \(value)"</span>)</div><div class="line">        </div><div class="line">    &#125;).disposed(by: disposeBag)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 输出：</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">17</span>:<span class="number">05</span>:<span class="number">24</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">76</span>]：subscribe1 : <span class="number">1</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">17</span>:<span class="number">05</span>:<span class="number">24</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">76</span>]：subscribe1 : <span class="number">2</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">17</span>:<span class="number">05</span>:<span class="number">24</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">76</span>]：subscribe1 : <span class="number">3</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">17</span>:<span class="number">05</span>:<span class="number">24</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">96</span>]：subscribe2 : <span class="number">1</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">17</span>:<span class="number">05</span>:<span class="number">24</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">96</span>]：subscribe2 : <span class="number">2</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">17</span>:<span class="number">05</span>:<span class="number">24</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">96</span>]：subscribe2 : <span class="number">3</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">17</span>:<span class="number">05</span>:<span class="number">24</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">96</span>]：subscribe4 : <span class="number">1</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">17</span>:<span class="number">05</span>:<span class="number">24</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">96</span>]：subscribe4 : <span class="number">2</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">17</span>:<span class="number">05</span>:<span class="number">24</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">96</span>]：subscribe4 : <span class="number">3</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">17</span>:<span class="number">05</span>:<span class="number">26</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">86</span>]：subscribe3 : <span class="number">1</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">17</span>:<span class="number">05</span>:<span class="number">26</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">86</span>]：subscribe3 : <span class="number">2</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">17</span>:<span class="number">05</span>:<span class="number">26</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">86</span>]：subscribe3 : <span class="number">3</span></div></pre></td></tr></table></figure>
<p>可以发现每次数据都会重新发射一遍，是独立的，即 Observable 会为每个订阅者单独执行一次发射数据的代码。</p>
<h3 id="Hot-Observables"><a href="#Hot-Observables" class="headerlink" title="Hot Observables"></a>Hot Observables</h3><p>有新的事件它就发射，不考虑是否有订阅者订阅。而新的订阅者并不会接收到订阅前已经发射过的事件。</p>
<p>这里怎么理解呢？按钮的点击就是个经典的 🌰。屏幕上的一个按钮，不管有没有订阅者订阅它的点击事件，点击事件都会发生，我们都能通过手指点击屏幕上的按钮。当有订阅者订阅这个按钮后，我们就能收到按钮点击事件的反馈，但是没订阅之前的回调反馈是没有的。我们来看看代码：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> tap = button.rx.tap</div><div class="line">tap.subscribe(onNext: &#123;</div><div class="line">    <span class="type">DebugPrint</span>(<span class="string">"Tap 1"</span>)</div><div class="line">&#125;).disposed(by: disposeBag)</div><div class="line"></div><div class="line"><span class="type">DispatchQueue</span>.main.asyncAfter(deadline: <span class="type">DispatchTime</span>.now() + <span class="number">3</span>) &#123;</div><div class="line">    tap.subscribe(onNext: &#123;</div><div class="line">        <span class="type">DebugPrint</span>(<span class="string">"Tap 2"</span>)</div><div class="line">    &#125;).disposed(by: <span class="keyword">self</span>.disposeBag)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>比如 3 秒前，我们点击了三次 Button ，此后又点击了两次，总共五次按钮的点击。输出结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[2018-01-02 18:22:51 ViewController.swift viewDidLoad() 45]：Tap 1</div><div class="line">[2018-01-02 18:22:52 ViewController.swift viewDidLoad() 45]：Tap 1</div><div class="line">[2018-01-02 18:22:52 ViewController.swift viewDidLoad() 45]：Tap 1</div><div class="line">[2018-01-02 18:22:56 ViewController.swift viewDidLoad() 45]：Tap 1</div><div class="line">[2018-01-02 18:22:56 ViewController.swift viewDidLoad() 50]：Tap 2</div><div class="line">[2018-01-02 18:22:56 ViewController.swift viewDidLoad() 45]：Tap 1</div><div class="line">[2018-01-02 18:22:56 ViewController.swift viewDidLoad() 50]：Tap 2</div></pre></td></tr></table></figure>
<p>3 秒前第二个订阅者并没有订阅 tap ，故不会有 Tap 2 的输出。3 秒后第二个订阅者订阅了 tap ，此时点击 Button ，可以看到打印结果多了 Tap 2。但与 Cold Observable 不同的是，第二个订阅者不会收到之前三次的点击事件。</p>
<p>我们如果将 <code>button.rx.tap</code> 替换成 Cold Observables，可以看到打印结果有 5 个 Tap 2 ：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> tap = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.create &#123; (observer) -&gt; <span class="type">Disposable</span> <span class="keyword">in</span></div><div class="line">    observer.onNext(<span class="number">1</span>)</div><div class="line">    observer.onNext(<span class="number">2</span>)</div><div class="line">    observer.onNext(<span class="number">3</span>)</div><div class="line">    observer.onNext(<span class="number">4</span>)</div><div class="line">    observer.onNext(<span class="number">5</span>)</div><div class="line">    <span class="keyword">return</span> <span class="type">Disposables</span>.create()</div><div class="line">    &#125;.<span class="built_in">map</span>(&#123;<span class="number">_</span> <span class="keyword">in</span>&#125;)</div><div class="line">    </div><div class="line"><span class="comment">// 输出：</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">43</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">47</span>]：<span class="type">Tap</span> <span class="number">1</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">43</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">47</span>]：<span class="type">Tap</span> <span class="number">1</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">43</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">47</span>]：<span class="type">Tap</span> <span class="number">1</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">43</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">47</span>]：<span class="type">Tap</span> <span class="number">1</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">43</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">47</span>]：<span class="type">Tap</span> <span class="number">1</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">46</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">52</span>]：<span class="type">Tap</span> <span class="number">2</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">46</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">52</span>]：<span class="type">Tap</span> <span class="number">2</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">46</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">52</span>]：<span class="type">Tap</span> <span class="number">2</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">46</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">52</span>]：<span class="type">Tap</span> <span class="number">2</span></div><div class="line">[<span class="number">2018</span>-<span class="number">01</span>-<span class="number">02</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">46</span> <span class="type">ViewController</span>.swift viewDidLoad() <span class="number">52</span>]：<span class="type">Tap</span> <span class="number">2</span></div></pre></td></tr></table></figure>
<p>参考：</p>
<p><a href="https://beeth0ven.github.io/RxSwift-Chinese-Documentation/" target="_blank" rel="external">https://beeth0ven.github.io/RxSwift-Chinese-Documentation/</a><br><a href="https://medium.com/@DianQK/hot-observable%E5%92%8Ccold-observable-c3ba8d07867b" target="_blank" rel="external">https://medium.com/@DianQK/hot-observable%E5%92%8Ccold-observable-c3ba8d07867b</a><br><a href="https://juejin.im/entry/57f29c46da2f60004f68f663" target="_blank" rel="external">https://juejin.im/entry/57f29c46da2f60004f68f663</a><br><a href="https://github.com/ReactiveX/RxSwift/tree/master/Documentation" target="_blank" rel="external">https://github.com/ReactiveX/RxSwift/tree/master/Documentation</a><br><a href="https://github.com/Joe0708/RxSwift-Tutorial" target="_blank" rel="external">https://github.com/Joe0708/RxSwift-Tutorial</a></p>


                
            </div>


            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    




                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

                <ul class="list-inline text-center">
                    

                    

                    

                    

                    

                    

                    
                </ul>
                <p class="copyright text-muted">Get busy living, or get busy dying~ <br>Copyright &copy; Hexo-CleanBlog 2016-2018 <br></p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>

<!-- Bootstrap -->
<script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdn.bootcss.com/featherlight/1.7.1/featherlight.gallery.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>